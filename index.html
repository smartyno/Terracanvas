<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>terracanvas</title>
  <!-- Include the p5.js library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
  <!-- Include the p5.svg library -->
  <script src="https://cdn.jsdelivr.net/npm/p5.svg@0.4.1/dist/p5.svg.js"></script>
</head>
<body>
  <!-- Create a container for your p5.js sketch -->
  <div id="sketch-container"></div>

<script>

let svgList = [];
let grid = [];
const gridSize = 32;
const svgWidth = 15;
const svgHeight = 20;
let selectedSVG = 1;
let input;
let fillInput; // Input field for fill color
let cellColors = []; // Store fill colors for each cell

// Define one color palette with a default fill color
const colorPalette = {
  cellFill: '#626262', // Default fill color
};

function preload() {
  // Load SVG files from the GitHub repository
  for (let i = 0; i < 75; i++) {
  // Replace 'username/repo' and 'path/to/svg' with your GitHub repository's information
    let githubRawURL = `https://raw.githubusercontent.com/smartyno/Terracanvas/main/symbols/s${i + 1}.svg`;
    svgList[i] = loadImage(githubRawURL);
  }
}

function setup() {
   // Create a p5.js canvas within the sketch-container
    let canvas = createCanvas(300, 300);
        canvas.parent('sketch-container'); // Set the parent of the canvas

    background(50);
  
    createCanvas(gridSize * svgWidth, gridSize * svgHeight);

  // Initialize the grid with default SVG IDs (1 to 75) and fill color
  for (let x = 0; x < gridSize; x++) {
    grid[x] = [];
    cellColors[x] = [];
    for (let y = 0; y < gridSize; y++) {
      grid[x][y] = selectedSVG; // Default SVG ID
      cellColors[x][y] = colorPalette.cellFill; // Default fill color
    }
  }

  // Create input field for numeric input
  input = createInput();
  input.position(10, 10);
  input.attribute('placeholder', 'Enter SVG ID (1-75)');
  input.input(handleInput);

  // Create input field for fill color
  fillInput = createInput(colorPalette.cellFill);
  fillInput.position(10, 40);
  fillInput.attribute('placeholder', 'Enter cell fill, e.g. #626262');


}

function draw() {
  background(50);

  // Display the grid with SVGs
let gridY = 60; // You can change this value to control the vertical position
 for (let x = 0; x < gridSize; x++) {
    for (let y = 0; y < gridSize; y++) {
        let svgID = grid[x][y];

      // Apply the fill color to the SVG
      let cellFill = cellColors[x][y];

      push();
      stroke(255, 51); // White stroke with 20% opacity
      strokeWeight(1); // Thin stroke
      fill(cellFill);
      rect(x * svgWidth, y * svgHeight + gridY, svgWidth, svgHeight); // Adjust Y position
      image(svgList[svgID - 1], x * svgWidth, y * svgHeight + gridY, svgWidth, svgHeight); // Adjust Y position
      pop();
    }
  }
}

function mouseClicked() {
  // Change SVG and fill color at the clicked coordinates
  let x = floor(mouseX / svgWidth);
  let y = floor(mouseY / svgHeight);

  // Assign a new SVG ID to the clicked coordinate
  grid[x][y] = selectedSVG;

  // Assign a new fill color to the clicked coordinate
  cellColors[x][y] = fillInput.value();

  // Update the grid
  redraw();
}

// Handle numeric input from the user
function handleInput() {
  let newValue = input.value();
  if (!isNaN(newValue) && (newValue >= 1 && newValue <= 75)) {
    selectedSVG = int(newValue);
    console.log(`Selected SVG: ${selectedSVG}`);
  } else {
    console.error("Invalid input. Enter a numeric value between 1 and 75.");
  }
}

  </script>
</body>
</html>
